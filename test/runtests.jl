using Motifs
@static if VERSION < v"0.7.0-DEV.2005"
    using Base.Test
else
    using Test
end

using BenchmarkTools
using LightGraphs

@test Motifs.getmotifs(LightGraphs.WheelGraph(100),4; norm=false) == Dict(
	Motifs.MotifSig(UInt64[0x1000000000000000, 0x3000000000000000, 0x5000000000000000, 0xe000000000000000], Int32[1, 2000000002, 1, 0]) => 9405.0,
	Motifs.MotifSig(UInt64[0x2000000000000000, 0x1000000000000000, 0x9000000000000000, 0x6000000000000000], Int32[2000000002, 1, 2000000002, 0]) => 99.0,
	Motifs.MotifSig(UInt64[0x3000000000000000, 0x3000000000000000, 0xd000000000000000, 0xe000000000000000], Int32[2000000002, 1, 2000000002, 0]) => 99.0,
	Motifs.MotifSig(UInt64[0x1000000000000000, 0x1000000000000000, 0x1000000000000000, 0xe000000000000000], Int32[2000000002, 2000000002, 1, 0]) => 147345.0,
)

# Need to add atol method for Dict before we can test norm works

# @test Motifs.getmotifs(LightGraphs.WheelGraph(100),4; norm=true) == Dict(
# 	Motifs.MotifSig(UInt64[0x1000000000000000, 0x3000000000000000, 0x5000000000000000, 0xe000000000000000], Int32[1, 2000000002, 1, 0]) => 0.0599243,
# 	Motifs.MotifSig(UInt64[0x2000000000000000, 0x1000000000000000, 0x9000000000000000, 0x6000000000000000], Int32[2000000002, 1, 2000000002, 0]) => 0.000630782,
# 	Motifs.MotifSig(UInt64[0x3000000000000000, 0x3000000000000000, 0xd000000000000000, 0xe000000000000000], Int32[2000000002, 1, 2000000002, 0]) => 0.000630782,
# 	Motifs.MotifSig(UInt64[0x1000000000000000, 0x1000000000000000, 0x1000000000000000, 0xe000000000000000], Int32[2000000002, 2000000002, 1, 0]) => 0.938814,
# )

println("The following should take about a second:")
@show @benchmark Motifs.getmotifs(WheelGraph(100),4)
